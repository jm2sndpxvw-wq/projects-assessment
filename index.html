â€<!DOCTYPE html>
â€<html lang="en">
â€<head>
â€  <meta charset="UTF-8" />
â€  <title>Projects Assessment â€“ Real Estate Team</title>
â€  <style>
â€    :root {
â€      --bg: #0b0d10;
â€      --bg-alt: #151921;
â€      --bg-alt-soft: #1b2029;
â€      --primary: #4f8cff;
â€      --primary-soft: #223455;
â€      --text: #f5f7fb;
â€      --text-muted: #9aa4c0;
â€      --danger: #ff4b5c;
â€      --warning: #ffbf47;
â€      --success: #28c76f;
â€      --border: #252c3a;
â€      --card-radius: 10px;
â€      --shadow-soft: 0 8px 20px rgba(0,0,0,0.45);
    }
â€    * { box-sizing: border-box; margin: 0; padding: 0; font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text","Segoe UI", sans-serif; }
â€    body { background: radial-gradient(circle at top, #1a2134 0, #05060a 55%); color: var(--text); min-height: 100vh; display: flex; justify-content: center; padding: 16px; }
â€    .app { width: 100%; max-width: 1280px; background: linear-gradient(135deg, #090b10 0, #111623 45%, #090b10 100%); border-radius: 18px; box-shadow: var(--shadow-soft); display: grid; grid-template-columns: 260px 1fr; overflow: hidden; border: 1px solid rgba(255,255,255,0.04); }

â€    /* Sidebar */
â€    .sidebar { background: radial-gradient(circle at top left, #20263a 0, #070910 55%); border-right: 1px solid var(--border); padding: 18px 16px; display: flex; flex-direction: column; gap: 16px; }
â€    .app-title { font-size: 18px; font-weight: 700; display:flex; align-items:center; gap:8px; }
â€    .app-title span.logo { width:26px; height:26px; border-radius:10px; display:inline-flex; align-items:center; justify-content:center; background: radial-gradient(circle at 30% 0, #7c8cff, #3a4bff, #141633); box-shadow:0 0 18px rgba(79,140,255,0.55); font-size:14px; }
â€    .app-sub { font-size:11px; color:var(--text-muted); margin-top:4px; }

â€    .team-header { display:flex; align-items:center; justify-content:space-between; margin-top:6px; margin-bottom:4px; }
â€    .team-header span { font-size:12px; color:var(--text-muted); letter-spacing:0.03em; text-transform:uppercase; }

â€    .team-list { display:flex; flex-direction:column; gap:6px; margin-bottom:6px; max-height:260px; overflow-y:auto; padding-right:4px; }
â€    .team-item { border-radius:10px; padding:8px 10px; background:rgba(16,21,34,0.9); border:1px solid transparent; display:flex; justify-content:space-between; align-items:center; cursor:pointer; transition:0.18s ease; position:relative; }
â€    .team-item.active { border-color:var(--primary); background: radial-gradient(circle at 0 0, #27345c 0, #131723 48%); box-shadow:0 0 0 1px rgba(79,140,255,0.4); }
â€    .team-item:hover { background:#171c29; }
â€    .team-main { display:flex; flex-direction:column; gap:3px; }
â€    .team-name { font-size:13px; font-weight:600; }
â€    .team-meta { font-size:11px; color:var(--text-muted); }
â€    .team-score-pill { padding:3px 8px; border-radius:999px; font-size:10px; font-weight:600; letter-spacing:0.04em; text-transform:uppercase; border:1px solid rgba(255,255,255,0.08); }
â€    .pill-red { color:var(--danger); border-color:rgba(255,75,92,0.65); }
â€    .pill-yellow { color:var(--warning); border-color:rgba(255,191,71,0.7); }
â€    .pill-green { color:var(--success); border-color:rgba(40,199,111,0.7); }

â€    .add-team { display:flex; gap:6px; margin-top:4px; }
â€    .add-team input { flex:1; padding:6px 8px; border-radius:999px; border:1px solid var(--border); background:rgba(8,10,16,0.9); color:var(--text); font-size:12px; outline:none; }
â€    .add-team button { border-radius:999px; padding:0 10px; font-size:11px; border:none; background:var(--primary); color:#fff; cursor:pointer; transition:0.18s ease; }
â€    .add-team button:hover { background:#3a70ff; }
â€    .hint-mini { font-size:10px; color:var(--text-muted); margin-top:2px; }
â€    .sidebar-footer { margin-top:auto; padding-top:8px; border-top:1px dashed rgba(255,255,255,0.07); font-size:11px; color:var(--text-muted); display:flex; flex-direction:column; gap:4px; }
â€    .sidebar-footer strong { color:var(--text); font-weight:600; }

â€    /* Main */
â€    .main { padding:18px 18px 18px 16px; display:flex; flex-direction:column; gap:10px; }
â€    .main-header { display:flex; justify-content:space-between; align-items:center; gap:8px; }
â€    .main-header-left { display:flex; flex-direction:column; gap:4px; }
â€    .main-title { font-size:16px; font-weight:600; }
â€    .main-sub { font-size:11px; color:var(--text-muted); }

â€    .main-actions { display:flex; gap:6px; align-items:center; flex-wrap:wrap; justify-content:flex-end; }
â€    .btn { padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,0.12); background:rgba(8,10,16,0.9); color:var(--text); font-size:11px; cursor:pointer; display:inline-flex; align-items:center; gap:4px; transition:0.18s ease; }
â€    .btn-primary { background:var(--primary); border-color:rgba(79,140,255,0.9); color:#fff; }
â€    .btn-primary:hover { background:#3a70ff; } .btn:hover { background:#171c29; }
â€    .btn input[type="file"]{ display:none; }

â€    .tabs-row { display:flex; gap:6px; font-size:11px; }
â€    .tab-btn { padding:5px 10px; border-radius:999px; border:1px solid var(--border); background:rgba(8,10,16,0.9); color:var(--text-muted); cursor:pointer; font-size:11px; }
â€    .tab-btn.active { background:var(--primary); border-color:rgba(79,140,255,0.9); color:#fff; }

â€    .hidden { display:none !important; }

â€    .filters-row { display:flex; gap:8px; align-items:center; font-size:11px; color:var(--text-muted); margin-top:6px; }
â€    .filters-row select { background:var(--bg-alt); color:var(--text); border-radius:999px; border:1px solid var(--border); padding:4px 8px; font-size:11px; outline:none; }
â€    .chip { padding:2px 8px; border-radius:999px; border:1px solid var(--border); font-size:10px; }
â€    .chip-soft { background:rgba(255,255,255,0.02); border-style:dashed; }

â€    .content-grid { display:grid; grid-template-columns:minmax(0,280px) minmax(0,1fr); gap:12px; margin-top:6px; height:calc(100% - 60px); min-height:0; }

â€    .panel { background:var(--bg-alt); border-radius:14px; border:1px solid var(--border); padding:10px 10px 12px; display:flex; flex-direction:column; gap:8px; overflow:hidden; }
â€    .panel-header { display:flex; justify-content:space-between; align-items:center; gap:6px; }
â€    .panel-title { font-size:12px; font-weight:600; }
â€    .panel-sub { font-size:10px; color:var(--text-muted); }
â€    .form-grid { display:grid; grid-template-columns:1fr; gap:6px; margin-top:2px; max-height:100%; overflow-y:auto; padding-right:2px; }
â€    .field { display:flex; flex-direction:column; gap:2px; }
â€    .field label { font-size:10px; color:var(--text-muted); }
â€    .field input, .field textarea, .field select { background:#0d1017; border-radius:8px; border:1px solid var(--border); padding:5px 7px; font-size:11px; color:var(--text); outline:none; }
â€    .field input:focus, .field textarea:focus, .field select:focus { border-color:var(--primary); }
â€    .field textarea { min-height:40px; resize:vertical; }

â€    .scores-grid { display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); gap:4px 8px; }
â€    .score-input { width:100%; }
â€    .score-input::-webkit-outer-spin-button, .score-input::-webkit-inner-spin-button { -webkit-appearance:none; margin:0; }

â€    .projects-panel { position:relative; min-height:0; display:flex; flex-direction:column; }
â€    .cards-list { margin-top:4px; overflow-y:auto; padding-right:2px; display:flex; flex-direction:column; gap:6px; }

â€    .card { background:var(--bg-alt-soft); border-radius:12px; border:1px solid var(--border); padding:8px 9px; display:flex; flex-direction:column; gap:6px; cursor:pointer; transition:0.15s ease; }
â€    .card:hover { border-color:rgba(255,255,255,0.12); background:#191f2b; }
â€    .card.reassessed { box-shadow:0 0 0 1px rgba(40,199,111,0.4); }
â€    .card-header { display:flex; justify-content:space-between; align-items:center; gap:6px; }
â€    .card-title-block { display:flex; flex-direction:column; gap:2px; }
â€    .card-title { font-size:12px; font-weight:600; }
â€    .card-subtitle { font-size:10px; color:var(--text-muted); }
â€    .card-tag { padding:3px 8px; border-radius:999px; font-size:10px; border:1px solid var(--border); }
â€    .tag-red { color:var(--danger); border-color:rgba(255,75,92,0.7); }
â€    .tag-yellow { color:var(--warning); border-color:rgba(255,191,71,0.7); }
â€    .tag-green { color:var(--success); border-color:rgba(40,199,111,0.7); }
â€    .card-footer { display:flex; justify-content:space-between; align-items:center; gap:6px; font-size:10px; color:var(--text-muted); flex-wrap:wrap; }
â€    .card-footer span.bold { font-weight:600; color:var(--text); font-size:11px; }
â€    .details { margin-top:4px; border-top:1px dashed rgba(255,255,255,0.08); padding-top:4px; display:none; font-size:10px; color:var(--text-muted); }
â€    .details-row { display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); gap:3px 10px; margin-top:2px; }
â€    .details-row span { display:flex; justify-content:space-between; }
â€    .details-row span strong { font-weight:500; color:var(--text); }
â€    .card.open .details { display:block; }
â€    .training-panel { font-size:11px; color:var(--text-muted); display:flex; flex-direction:column; gap:4px; margin-top:4px; }
â€    .training-list { font-size:10px; line-height:1.4; max-height:90px; overflow-y:auto; padding-right:2px; }
â€    .empty-state { font-size:11px; color:var(--text-muted); padding:12px 4px; text-align:center; }
â€    .print-only { display:none; }

â€    /* Conversion */
â€    .conversion-layout { display:grid; grid-template-columns:minmax(0,260px) minmax(0,1fr); gap:12px; margin-top:6px; }
â€    .conversion-table { width:100%; border-collapse:collapse; font-size:10px; }
â€    .conversion-table th, .conversion-table td { border:1px solid var(--border); padding:4px 5px; text-align:center; }
â€    .conversion-table th { font-size:10px; background:#151a25; }
â€    .conversion-table td input { width:100%; border-radius:6px; border:1px solid var(--border); background:#05070b; color:var(--text); font-size:10px; padding:3px 4px; text-align:center; }
â€    .conversion-table .sales-name-cell { text-align:left; font-weight:600; font-size:11px; }
â€    .percent-chip { font-size:9px; margin-top:2px; display:inline-block; }
â€    .percent-good { color:var(--success); } .percent-mid { color:var(--warning); } .percent-bad { color:var(--danger); }
â€    .conversion-summary { font-size:10px; color:var(--text-muted); margin-top:6px; line-height:1.5; }
â€    .conversion-summary-line { margin-bottom:2px; }
â€    .sales-total-row td { background:#101521; font-weight:600; }

â€    /* Members overview styles */
â€    .overview-panel { padding:10px; }
â€    .overview-grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap:10px; margin-top:8px; }
â€    .member-card { background:var(--bg-alt-soft); border:1px solid var(--border); border-radius:12px; padding:10px; display:flex; flex-direction:column; gap:8px; }
â€    .member-top { display:flex; justify-content:space-between; align-items:center; gap:8px; }
â€    .member-name { font-weight:700; font-size:14px; }
â€    .member-meta { font-size:11px; color:var(--text-muted); }
â€    .scores-row { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
â€    .score-block { flex:1; min-width:96px; padding:8px; border-radius:8px; background:rgba(8,10,16,0.6); border:1px solid rgba(255,255,255,0.02); text-align:center; }
â€    .score-label { font-size:11px; color:var(--text-muted); margin-bottom:4px; }
â€    .score-value { font-weight:700; font-size:16px; }
â€    .total-performance { display:flex; align-items:center; gap:8px; justify-content:space-between; padding:8px; border-radius:8px; background:linear-gradient(90deg, rgba(10,12,18,0.6), rgba(15,18,28,0.6)); border:1px solid rgba(255,255,255,0.03); }
â€    .trend { font-size:13px; display:flex; align-items:center; gap:6px; color:var(--text-muted); }
â€    .trend.up { color:var(--success); } .trend.down { color:var(--danger); } .trend.flat { color:var(--text-muted); }

â€    /* scrollbar */
â€    ::-webkit-scrollbar { width:5px; }
â€    ::-webkit-scrollbar-track { background:transparent; }
â€    ::-webkit-scrollbar-thumb { background:#303545; border-radius:999px; }

â€    @media (max-width:900px) {
â€      .app { grid-template-columns:1fr; }
â€      .sidebar { border-right:none; border-bottom:1px solid var(--border); flex-direction:column; }
â€      .content-grid, .conversion-layout { grid-template-columns:1fr; height:auto; }
    }

â€    @media print {
â€      body { background:#05060a !important; -webkit-print-color-adjust:exact; print-color-adjust:exact; }
â€      .app, .sidebar, .main, .panel, .card, .team-item.active, .filters-row, .training-panel { background-color:#111623 !important; color:#f5f7fb !important; }
â€      .main-actions, .tabs-row { display:none !important; }
â€      #assessmentTab .content-grid { grid-template-columns:1fr !important; }
â€      #assessmentTab .content-grid > section:first-child { display:none !important; }
â€      .team-item { display:none !important; }
â€      .team-item.active { display:flex !important; }
â€      .add-team, .hint-mini { display:none !important; }
â€      #projectsList { display:none !important; }
â€      #printProjectsList { display:flex !important; }
â€      #assessmentTab.hidden, #conversionTab.hidden, #overviewTab.hidden { display:none !important; }
    }
â€  </style>
â€</head>
â€<body>
â€  <div class="app">
â€    <!-- SIDEBAR -->
â€    <aside class="sidebar">
â€      <div>
â€        <div class="app-title">
â€          <span class="logo">BR</span>
â€          <div>
â€            Bold Routes â€“ Projects Assessment
â€            <div class="app-sub">Dark mode â€¢ Compact â€¢ Team based</div>
â€          </div>
â€        </div>
â€      </div>

â€      <div class="team-header">
â€        <span>Team members</span>
â€      </div>
â€      <div class="team-list" id="teamList"></div>

â€      <div class="add-team">
â€        <input id="newMemberInput" placeholder="Add new member..." />
â€        <button id="addMemberBtn" type="button">Add</button>
â€      </div>
â€      <div class="hint-mini">Long press on member name to delete ğŸ—‘ï¸</div>

â€      <div class="sidebar-footer">
â€        <div>
â€          <strong>Color codes (Project):</strong><br />
â€          ğŸŸ¥ &lt; 60% â€“ Needs training<br />
â€          ğŸŸ¨ 60â€“79% â€“ Average<br />
â€          ğŸŸ© â‰¥ 80% â€“ Confident
â€        </div>
â€      </div>
â€    </aside>

â€    <!-- MAIN -->
â€    <main class="main">
â€      <div class="main-header">
â€        <div class="main-header-left">
â€          <div class="main-title" id="currentMemberTitle">Select team member</div>
â€          <div class="main-sub" id="currentMemberSub">Choose a team member from the left to start assessment.</div>
â€        </div>
â€        <div class="main-actions">
â€          <button class="btn" id="exportBtn" type="button">Export PDF (Current)</button>
â€          <button class="btn" id="backupBtn" type="button">Backup</button>
â€          <label class="btn"> Restore file <input type="file" id="restoreFileInput" accept="application/json" /></label>
â€          <button class="btn" id="restoreAutoBtn" type="button">Restore auto</button>
â€        </div>
â€      </div>

â€      <!-- Tabs -->
â€      <div class="tabs-row">
â€        <button class="tab-btn active" data-tab="assessment">Assessment</button>
â€        <button class="tab-btn" data-tab="conversion">Conversion</button>
â€        <button class="tab-btn" data-tab="overview">Members overview</button>
â€      </div>

â€      <!-- ASSESSMENT TAB -->
â€      <div id="assessmentTab">
â€        <div class="filters-row">
â€          <span>Region:</span>
â€          <select id="regionFilter"><option value="all">All regions</option></select>
â€          <span>Developer:</span>
â€          <select id="developerFilter"><option value="all">All developers</option></select>
â€          <span class="chip chip-soft" id="regionStats">No projects yet</span>
â€        </div>

â€        <div class="content-grid">
â€          <!-- LEFT: FORM -->
â€          <section class="panel">
â€            <div class="panel-header">
â€              <div>
â€                <div class="panel-title" id="formTitle">New Project Assessment</div>
â€                <div class="panel-sub">Rate each point from 0 to 10 (English labels)</div>
â€              </div>
â€            </div>

â€            <div class="form-grid">
â€              <div class="field"><label>Project name</label><input id="projectName" placeholder="e.g. New Zayed Lakes" /></div>
â€              <div class="field"><label>Developer</label><input id="projectDeveloper" placeholder="e.g. Emaar, SODIC..." /></div>
â€              <div class="field"><label>Region / Area</label><input id="projectRegion" placeholder="e.g. New Zayed, NAC..." /></div>

â€              <div class="scores-grid">
â€                <div class="field"><label>Development</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scoreDevelopment" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Location</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scoreLocation" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Masterplan</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scoreMasterplan" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Facilities</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scoreFacilities" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Type mix</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scoreType" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Price positioning</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scorePrice" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Payment plan</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scorePayment" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Delivery date</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scoreDelivery" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Finishing quality</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scoreFinishing" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Maintenance (deposit)</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scoreMaintenance" placeholder="0â€“10" /></div>
â€                <div class="field"><label>Orientation skills</label><input type="number" min="0" max="10" step="0.5" class="score-input" id="scoreOrientation" placeholder="0â€“10" /></div>
â€              </div>

â€              <div class="field"><label>Notes (optional)</label><textarea id="projectNotes" placeholder="Any remarks, red flags, comparison with competitors..."></textarea></div>

â€              <div class="submit-row">
â€                <button class="btn btn-primary" id="addProjectBtn" type="button">Save project</button>
â€                <button class="btn" id="cancelEditBtn" type="button">Cancel edit</button>
â€              </div>
â€            </div>
â€          </section>

â€          <!-- RIGHT: CARDS + TRAINING -->
â€          <section class="panel projects-panel">
â€            <div class="panel-header">
â€              <div>
â€                <div class="panel-title">Projects & Scores</div>
â€                <div class="panel-sub">Click on a card to expand details â€“ filtered by region & developer.</div>
â€              </div>
â€            </div>

â€            <div class="cards-list" id="projectsList"><div class="empty-state">No projects yet. Add a new assessment on the left.</div></div>
â€            <div class="cards-list print-only" id="printProjectsList"></div>

â€            <div class="training-panel">
â€              <div><strong>Ø®Ø·Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ (Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒ): Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù Ø­Ø³Ø¨ ÙƒÙ„ Ù…Ø´Ø±ÙˆØ¹</strong></div>
â€              <div class="training-list" id="trainingList">Ù„Ø³Ù‡ Ù…Ø§ÙÙŠØ´ Ø¯Ø§ØªØ§ ÙƒÙØ§ÙŠØ© Ø¯Ù„ÙˆÙ‚ØªÙŠ.</div>
â€              <div style="margin-top:4px;"><strong>Ù†Ù‚Ø· Ù…ØªÙƒØ±Ø±Ø© Ø£Ù‚Ù„ Ù…Ù† Ù¥/Ù¡Ù  Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ ÙƒÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹:</strong></div>
â€              <div class="training-list" id="trainingSummaryList">Ù„Ø³Ù‡ Ù…Ø§ÙÙŠØ´ Ø¯Ø§ØªØ§ ÙƒÙØ§ÙŠØ© Ø¯Ù„ÙˆÙ‚ØªÙŠ.</div>
â€            </div>
â€          </section>
â€        </div>
â€      </div>

â€      <!-- CONVERSION TAB -->
â€      <div id="conversionTab" class="hidden">
â€        <div class="conversion-layout">
â€          <section class="panel">
â€            <div class="panel-header"><div><div class="panel-title">Daily conversion</div><div class="panel-sub">Sales write numbers, tool calculates %</div></div></div>
â€            <div class="form-grid">
â€              <div class="field"><label>Select date</label><input type="date" id="convDate" /></div>
â€              <div class="field"><label>Targets mode</label><small>Choose per day / per month for each metric</small></div>
â€              <div class="field">
â€                <table class="conversion-table">
â€                  <thead><tr><th>Metric</th><th>Target</th><th>Mode</th><th>Daily</th><th>Monthly</th></tr></thead>
â€                  <tbody id="convTargetsBody"></tbody>
â€                </table>
â€              </div>
â€            </div>
â€          </section>

â€          <section class="panel">
â€            <div class="panel-header"><div><div class="panel-title">Team performance (per day & month)</div><div class="panel-sub">Numbers per sales â€“ plus monthly totals under each one</div></div></div>

â€            <div style="overflow-x:auto;">
â€              <table class="conversion-table" id="convTable">
â€                <thead><tr><th>Sales name</th><th>Deals</th><th>Scheduled</th><th>Meetings</th><th>Requests</th><th>Call back</th><th>Active calls</th><th>Calls</th><th>Total %</th></tr></thead>
â€                <tbody id="convTableBody"></tbody>
â€              </table>
â€            </div>

â€            <div class="conversion-summary" id="convSummary">Ù…ÙÙŠØ´ Ø¯Ø§ØªØ§ Ù„Ø³Ù‡ Ù„Ù„ÙŠÙˆÙ… Ø¯Ù‡.</div>
â€          </section>
â€        </div>
â€      </div>

â€      <!-- OVERVIEW TAB -->
â€      <div id="overviewTab" class="hidden">
â€        <div class="panel overview-panel">
â€          <div class="panel-header">
â€            <div><div class="panel-title">Members overview</div><div class="panel-sub">50/50 weight â€” Assessment & Conversion combined (Total performance)</div></div>
â€            <div>
â€              <small class="panel-sub">Date for conversion: <span id="overviewDateLabel"></span></small>
â€            </div>
â€          </div>

â€          <div style="display:flex; gap:8px; align-items:center; margin-top:8px;">
â€            <label style="font-size:11px; color:var(--text-muted);">Choose month date:</label>
â€            <input type="month" id="overviewMonthInput" style="background:#0d1017; border-radius:8px; padding:6px; border:1px solid var(--border); color:var(--text);" />
â€          </div>

â€          <div class="overview-grid" id="overviewGrid"></div>
â€        </div>
â€      </div>
â€    </main>
â€  </div>

â€  <script>
â€    const STORAGE_KEY = "br_assessment_v3";
â€    const AUTO_BACKUP_KEY = "br_assessment_autobackup_v1";
â€    const ALL_TEAM_ID = "__ALL_TEAM__";

â€    // Conversion metrics
â€    const CONV_METRICS = ["deals","scheduled","meetings","requests","callBack","activeCalls","calls"];
â€    const CONV_TARGET_METRICS = ["deals","scheduled","meetings","requests","calls"];
â€    function hasTarget(metric){ return CONV_TARGET_METRICS.includes(metric); }
â€    const CONV_LABELS = { deals: "Deals", scheduled: "Scheduled", meetings: "Meetings", requests: "Requests", callBack: "Call back", activeCalls: "Active calls", calls: "Calls" };

â€    let state = { members: [], selectedMemberId: null, activeTab: "assessment", conversion: { currentDate: null, targets: {}, entries: {} } };
â€    let editingProjectId = null;

â€    function initConversionState() {
â€      if (!state.conversion) state.conversion = { currentDate: null, targets: {}, entries: {} };
â€      if (!state.conversion.targets) state.conversion.targets = {};
â€      CONV_TARGET_METRICS.forEach(m => { if (!state.conversion.targets[m]) state.conversion.targets[m] = { mode: "day", value: 0 }; });
â€      if (!state.conversion.entries) state.conversion.entries = {};
    }

â€    function loadState(){
â€      const raw = localStorage.getItem(STORAGE_KEY);
â€      if (raw) {
â€        try { state = JSON.parse(raw); } catch(e){ console.error("Failed parse", e); }
      }
â€      if (!state.members) state.members = [];
â€      if (!state.selectedMemberId && state.members.length > 0) state.selectedMemberId = state.members[0].id;
â€      if (!state.activeTab) state.activeTab = "assessment";
â€      initConversionState();
    }

â€    function autoBackup(){ try{ localStorage.setItem(AUTO_BACKUP_KEY, JSON.stringify(state)); }catch(e){ console.warn("Auto backup failed", e); } }
â€    function saveState(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); autoBackup(); }
â€    function uid(){ return Date.now().toString(36) + Math.random().toString(16).slice(2); }
â€    function todayISO(){ const d=new Date(); const m=String(d.getMonth()+1).padStart(2,"0"); const day=String(d.getDate()).padStart(2,"0"); return `${d.getFullYear()}-${m}-${day}`; }
â€    function daysInMonth(dateStr){ const [y,m] = dateStr.split("-").map(n=>parseInt(n,10)); return new Date(y,m,0).getDate(); }
â€    function monthPrefixFromDateStr(dateStr){ const [y,m] = dateStr.split("-"); return `${y}-${m}`; }

â€    // Elements
â€    const teamListEl = document.getElementById("teamList");
â€    const newMemberInput = document.getElementById("newMemberInput");
â€    const addMemberBtn = document.getElementById("addMemberBtn");
â€    const currentMemberTitle = document.getElementById("currentMemberTitle");
â€    const currentMemberSub = document.getElementById("currentMemberSub");
â€    const regionFilter = document.getElementById("regionFilter");
â€    const developerFilter = document.getElementById("developerFilter");
â€    const regionStats = document.getElementById("regionStats");
â€    const projectsListEl = document.getElementById("projectsList");
â€    const printProjectsListEl = document.getElementById("printProjectsList");
â€    const trainingListEl = document.getElementById("trainingList");
â€    const trainingSummaryListEl = document.getElementById("trainingSummaryList");
â€    const exportBtn = document.getElementById("exportBtn");
â€    const backupBtn = document.getElementById("backupBtn");
â€    const restoreFileInput = document.getElementById("restoreFileInput");
â€    const restoreAutoBtn = document.getElementById("restoreAutoBtn");

â€    const projectNameEl = document.getElementById("projectName");
â€    const projectDeveloperEl = document.getElementById("projectDeveloper");
â€    const projectRegionEl = document.getElementById("projectRegion");
â€    const projectNotesEl = document.getElementById("projectNotes");
â€    const addProjectBtn = document.getElementById("addProjectBtn");
â€    const cancelEditBtn = document.getElementById("cancelEditBtn");
â€    const formTitleEl = document.getElementById("formTitle");
â€    const defaultFormTitle = formTitleEl.textContent;

â€    const tabButtons = document.querySelectorAll(".tab-btn");
â€    const assessmentTabEl = document.getElementById("assessmentTab");
â€    const conversionTabEl = document.getElementById("conversionTab");
â€    const overviewTabEl = document.getElementById("overviewTab");

â€    const convDateEl = document.getElementById("convDate");
â€    const convTargetsBody = document.getElementById("convTargetsBody");
â€    const convTableBody = document.getElementById("convTableBody");
â€    const convSummaryEl = document.getElementById("convSummary");

â€    const overviewGrid = document.getElementById("overviewGrid");
â€    const overviewMonthInput = document.getElementById("overviewMonthInput");
â€    const overviewDateLabel = document.getElementById("overviewDateLabel");

â€    const scoreIds = ["scoreDevelopment","scoreLocation","scoreMasterplan","scoreFacilities","scoreType","scorePrice","scorePayment","scoreDelivery","scoreFinishing","scoreMaintenance","scoreOrientation"];
â€    const SCORE_LABELS = { development:"Development", location:"Location", masterplan:"Masterplan", facilities:"Facilities", type:"Type mix", price:"Price positioning", payment:"Payment plan", delivery:"Delivery date", finishing:"Finishing", maintenance:"Maintenance", orientation:"Orientation skills" };

â€    function getCurrentMember(){
â€      if (state.selectedMemberId === ALL_TEAM_ID) {
â€        // return simplified all-team object (no projects shown in conversion)
â€        return { id: ALL_TEAM_ID, name: "All team", isAllTeam: true, projects: state.members.flatMap(m => (m.projects||[]).map(p => ({...p, ownerName: m.name}))) };
      }
â€      return state.members.find(m => m.id === state.selectedMemberId) || null;
    }

â€    // Assessment averages
â€    function computeAssessmentAverage(member){
â€      const projects = member?.projects || [];
â€      if (projects.length === 0) return 0;
â€      let sum = 0;
â€      projects.forEach(p => sum += p.overallPercent || 0);
â€      return sum / projects.length;
    }
â€    function computeAssessmentAllTeamAverage(){
â€      let sum=0; let count=0;
â€      state.members.forEach(m => { const avg = computeAssessmentAverage(m); if (m.projects && m.projects.length>0){ sum += avg; count++; }});
â€      if (!count) return 0; return sum/count;
    }

â€    // Conversion monthly score (per member)
â€    function getMonthlyTarget(metric, dateStr){
â€      if (!hasTarget(metric)) return 0;
â€      const cfg = state.conversion.targets[metric]; if (!cfg) return 0;
â€      const days = daysInMonth(dateStr);
â€      if (cfg.mode === "day") return (cfg.value || 0) * days;
â€      return cfg.value || 0;
    }
â€    function getDailyTargetForPercent(metric, dateStr){
â€      if (!hasTarget(metric)) return 0;
â€      const cfg = state.conversion.targets[metric]; if (!cfg) return 0;
â€      if (cfg.mode === "day") return cfg.value || 0;
â€      return cfg.value || 0;
    }

â€    function computeConversionMonthlyScoreForMember(memberId, dateStr){
â€      if (!dateStr) dateStr = state.conversion.currentDate || todayISO();
â€      const [y,m] = dateStr.split("-");
â€      const prefix = `${y}-${m}`;
â€      const totals = {}; CONV_METRICS.forEach(metric => totals[metric]=0);

â€      Object.entries(state.conversion.entries).forEach(([day, perMember])=>{
â€        if (!day.startsWith(prefix)) return;
â€        const entry = perMember[memberId];
â€        if (!entry) return;
â€        CONV_METRICS.forEach(metric => totals[metric] += entry[metric] || 0);
      });

â€      let sumPct=0; let count=0;
â€      CONV_TARGET_METRICS.forEach(metric=>{
â€        const monthlyTarget = getMonthlyTarget(metric, dateStr);
â€        if (monthlyTarget > 0) {
â€          const pct = (totals[metric] / monthlyTarget) * 100;
â€          sumPct += pct; count++;
        }
      });
â€      if (!count) return 0;
â€      return sumPct / count;
    }

â€    function computeConversionAllTeamAverage(dateStr){
â€      if (!state.members.length) return 0;
â€      if (!dateStr) dateStr = state.conversion.currentDate || todayISO();
â€      let sum=0; let count=0;
â€      state.members.forEach(m => { const s = computeConversionMonthlyScoreForMember(m.id, dateStr); sum += s; count++; });
â€      if (!count) return 0; return sum/count;
    }

â€    function percentClass(percent){
â€      if (percent >= 100) return "percent-good";
â€      if (percent >= 60) return "percent-mid";
â€      return "percent-bad";
    }

â€    // Render team list
â€    function renderTeamList(){
â€      teamListEl.innerHTML = "";
â€      if (state.members.length === 0) {
â€        const div = document.createElement("div"); div.className="empty-state"; div.textContent="Add your team members to start."; teamListEl.appendChild(div);
â€        currentMemberTitle.textContent = "Select team member"; currentMemberSub.textContent = "Choose a team member from the left to start assessment.";
â€        return;
      }

â€      const currentDate = state.conversion.currentDate || todayISO();

â€      // All team item
â€      let totalProjects=0; state.members.forEach(m => totalProjects += (m.projects?.length||0));
â€      const allItem = document.createElement("div"); allItem.className = "team-item" + (state.selectedMemberId===ALL_TEAM_ID ? " active":"");
â€      const allMain = document.createElement("div"); allMain.className="team-main";
â€      const allName = document.createElement("div"); allName.className="team-name"; allName.textContent="All team";
â€      const allMeta = document.createElement("div"); allMeta.className="team-meta";
â€      // show only member count for overview/conversion per your request
â€      allMeta.textContent = state.members.length + " member(s)";
â€      allMain.appendChild(allName); allMain.appendChild(allMeta);
â€      const allPill = document.createElement("div"); allPill.className="team-score-pill";
â€      let allAvg = 0;
â€      if (state.activeTab === "conversion") allAvg = computeConversionAllTeamAverage(currentDate); else allAvg = computeAssessmentAllTeamAverage();
â€      if ((state.activeTab === "assessment" && totalProjects === 0) || (state.activeTab === "conversion" && !state.members.length)) {
â€        allPill.textContent = "No score"; allPill.classList.add("pill-yellow");
â€      } else {
â€        allPill.textContent = `${allAvg.toFixed(0)}%`;
â€        if (allAvg < 60) allPill.classList.add("pill-red"); else if (allAvg < 80) allPill.classList.add("pill-yellow"); else allPill.classList.add("pill-green");
      }
â€      allItem.appendChild(allMain); allItem.appendChild(allPill);
â€      allItem.addEventListener("click", ()=>{ state.selectedMemberId = ALL_TEAM_ID; saveState(); renderAll(); });
â€      teamListEl.appendChild(allItem);

â€      // members
â€      state.members.forEach(member=>{
â€        const item = document.createElement("div"); item.className="team-item"+(member.id===state.selectedMemberId?" active":""); item.dataset.id = member.id;
â€        const main = document.createElement("div"); main.className="team-main";
â€        const nameEl = document.createElement("div"); nameEl.className="team-name"; nameEl.textContent = member.name;
â€        const metaEl = document.createElement("div"); metaEl.className="team-meta";
â€        const projectsCount = member.projects?.length || 0;
â€        if (state.activeTab === "assessment") metaEl.textContent = projectsCount + " project" + (projectsCount!==1 ? "s":"");
â€        else metaEl.textContent = "Conversion";
â€        main.appendChild(nameEl); main.appendChild(metaEl);

â€        const pill = document.createElement("div"); pill.className="team-score-pill";
â€        let avg = 0;
â€        if (state.activeTab === "conversion") avg = computeConversionMonthlyScoreForMember(member.id, currentDate);
â€        else avg = computeAssessmentAverage(member);

â€        if ((state.activeTab === "assessment" && projectsCount === 0) || (state.activeTab === "conversion" && !Object.keys(state.conversion.entries || {}).length)) {
â€          pill.textContent = "No score"; pill.classList.add("pill-yellow");
â€        } else {
â€          pill.textContent = `${avg.toFixed(0)}%`;
â€          if (avg < 60) pill.classList.add("pill-red"); else if (avg < 80) pill.classList.add("pill-yellow"); else pill.classList.add("pill-green");
        }

â€        item.appendChild(main); item.appendChild(pill);

â€        // long press delete
â€        let pressTimer=null; let longPressed=false;
â€        item.addEventListener("pointerdown", ()=>{
â€          longPressed=false; pressTimer=setTimeout(()=>{
â€            const ok = confirm(`ØªÙ…Ø³Ø­ ${member.name} ÙˆÙƒÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨ØªØ§Ø¹ØªÙ‡ØŸ`);
â€            if (ok) { longPressed=true; state.members = state.members.filter(m=>m.id!==member.id); if (state.selectedMemberId === member.id) state.selectedMemberId = state.members[0]?.id || ALL_TEAM_ID; saveState(); renderAll(); } else longPressed=false;
          },650);
        });
â€        ["pointerup","pointerleave","pointercancel"].forEach(ev=> item.addEventListener(ev, ()=>{ if (pressTimer){ clearTimeout(pressTimer); pressTimer=null; } }));
â€        item.addEventListener("click", ()=>{ if (longPressed) return; state.selectedMemberId = member.id; saveState(); renderAll(); });

â€        teamListEl.appendChild(item);
      });
    }

â€    // Filters + stats
â€    function renderFiltersAndStats(member){
â€      const projects = member?.projects || [];
â€      const regions = new Set(); const developers = new Set();
â€      projects.forEach(p=>{ const r=(p.region||"").trim(); const d=(p.developer||"").trim(); if (r) regions.add(r); if (d) developers.add(d); });

â€      const prevRegion = regionFilter.value || "all"; const prevDev = developerFilter.value || "all";
â€      regionFilter.innerHTML=""; const allOptR=document.createElement("option"); allOptR.value="all"; allOptR.textContent="All regions"; regionFilter.appendChild(allOptR);
â€      Array.from(regions).forEach(r=>{ const opt=document.createElement("option"); opt.value=r; opt.textContent=r; regionFilter.appendChild(opt); });
â€      developerFilter.innerHTML=""; const allOptD=document.createElement("option"); allOptD.value="all"; allOptD.textContent="All developers"; developerFilter.appendChild(allOptD);
â€      Array.from(developers).forEach(d=>{ const opt=document.createElement("option"); opt.value=d; opt.textContent=d; developerFilter.appendChild(opt); });

â€      if (regions.has(prevRegion) || prevRegion==="all") regionFilter.value = prevRegion; else regionFilter.value="all";
â€      if (developers.has(prevDev) || prevDev==="all") developerFilter.value = prevDev; else developerFilter.value="all";

â€      if (projects.length===0) { regionStats.textContent="No projects yet"; return; }
â€      const selectedRegion = regionFilter.value; const selectedDev = developerFilter.value;
â€      const filtered = projects.filter(p=>{ const r=(p.region||"").trim(); const d=(p.developer||"").trim(); const regionMatch = selectedRegion==="all"?true:r===selectedRegion; const devMatch = selectedDev==="all"?true:d===selectedDev; return regionMatch && devMatch; });
â€      if (filtered.length===0){ regionStats.textContent="No projects with current filters"; return; }
â€      const sum = filtered.reduce((acc,p)=>acc+(p.overallPercent||0), 0); const avg = sum/filtered.length;
â€      regionStats.textContent = `Filtered: ${avg.toFixed(1)}% over ${filtered.length} project(s)`;
    }

â€    function tagFromPercent(percent){ if (percent < 60) return { text: "Needs Training", className: "tag-red" }; if (percent < 80) return { text: "Average", className: "tag-yellow" }; return { text: "Confident", className: "tag-green" }; }

â€    // Edit project load
â€    function startEditProject(project){ editingProjectId = project.id; formTitleEl.textContent = `Editing: ${project.name || "project"}`; projectNameEl.value = project.name || ""; projectDeveloperEl.value = project.developer || ""; projectRegionEl.value = project.region || ""; projectNotesEl.value = project.notes || ""; const s = project.scores || {}; document.getElementById("scoreDevelopment").value = typeof s.development==="number"?s.development:""; document.getElementById("scoreLocation").value = typeof s.location==="number"?s.location:""; document.getElementById("scoreMasterplan").value = typeof s.masterplan==="number"?s.masterplan:""; document.getElementById("scoreFacilities").value = typeof s.facilities==="number"?s.facilities:""; document.getElementById("scoreType").value = typeof s.type==="number"?s.type:""; document.getElementById("scorePrice").value = typeof s.price==="number"?s.price:""; document.getElementById("scorePayment").value = typeof s.payment==="number"?s.payment:""; document.getElementById("scoreDelivery").value = typeof s.delivery==="number"?s.delivery:""; document.getElementById("scoreFinishing").value = typeof s.finishing==="number"?s.finishing:""; document.getElementById("scoreMaintenance").value = typeof s.maintenance==="number"?s.maintenance:""; document.getElementById("scoreOrientation").value = typeof s.orientation==="number"?s.orientation:""; }

â€    // Render projects list
â€    function renderProjectsList(member){
â€      projectsListEl.innerHTML = "";
â€      if (!member || !member.projects || member.projects.length === 0) {
â€        const div = document.createElement("div"); div.className="empty-state"; div.textContent="No projects yet. Add a new assessment on the left."; projectsListEl.appendChild(div); trainingListEl.textContent="Ù„Ø³Ù‡ Ù…Ø§ÙÙŠØ´ Ø¯Ø§ØªØ§ ÙƒÙØ§ÙŠØ© Ø¯Ù„ÙˆÙ‚ØªÙŠ."; trainingSummaryListEl.textContent="Ù„Ø³Ù‡ Ù…Ø§ÙÙŠØ´ Ø¯Ø§ØªØ§ ÙƒÙØ§ÙŠØ© Ø¯Ù„ÙˆÙ‚ØªÙŠ."; return;
      }

â€      const selectedRegion = regionFilter.value || "all"; const selectedDev = developerFilter.value || "all";
â€      const projects = member.projects.filter(p=>{ const r=(p.region||"").trim(); const d=(p.developer||"").trim(); const regionMatch = selectedRegion==="all"?true:r===selectedRegion; const devMatch = selectedDev==="all"?true:d===selectedDev; return regionMatch && devMatch; });

â€      if (projects.length===0){ const div=document.createElement("div"); div.className="empty-state"; div.textContent="No projects with current filters."; projectsListEl.appendChild(div); }
â€      else {
â€        projects.slice().sort((a,b)=>b.createdAt - a.createdAt).forEach(project=>{
â€          const card = document.createElement("div"); card.className="card"; card.dataset.id = project.id;
â€          if (typeof project.lastDelta === "number") card.classList.add("reassessed");
â€          const header = document.createElement("div"); header.className="card-header";
â€          const titleBlock = document.createElement("div"); titleBlock.className="card-title-block";
â€          const title = document.createElement("div"); title.className="card-title"; title.textContent = project.name || "Untitled project";
â€          const subtitle = document.createElement("div"); subtitle.className="card-subtitle";
â€          const bits = []; if (project.region) bits.push(project.region); if (project.developer) bits.push(project.developer); bits.push(`${project.overallPercent.toFixed(1)}%`); subtitle.textContent = bits.join(" â€¢ ");
â€          titleBlock.appendChild(title); titleBlock.appendChild(subtitle);
â€          const tagEl = document.createElement("div"); const tagInfo = tagFromPercent(project.overallPercent); tagEl.className = "card-tag " + tagInfo.className; tagEl.textContent = tagInfo.text;
â€          header.appendChild(titleBlock); header.appendChild(tagEl);

â€          const footer = document.createElement("div"); footer.className="card-footer";
â€          const created = document.createElement("span"); const date = new Date(project.createdAt || Date.now()); created.textContent = `Added: ${date.toLocaleDateString()}`;
â€          const scoreSpan = document.createElement("span"); scoreSpan.innerHTML = `<span class="bold">${project.overallPercent.toFixed(1)}%</span> avg (0â€“10 scale)`;
â€          footer.appendChild(created); footer.appendChild(scoreSpan);

â€          if (typeof project.lastDelta === "number") {
â€            const trend = document.createElement("span"); const diff = project.lastDelta;
â€            if (diff > 0) { trend.textContent = `Reassessment: Improved +${diff.toFixed(1)} pts`; trend.style.color = "#28c76f"; } else if (diff < 0) { trend.textContent = `Reassessment: Dropped ${diff.toFixed(1)} pts`; trend.style.color = "#ff4b5c"; } else { trend.textContent = "Reassessment: No change"; trend.style.color = "#9aa4c0"; }
â€            footer.appendChild(trend);
          }

â€          const details = document.createElement("div"); details.className="details";
â€          const rows = document.createElement("div"); rows.className="details-row";
â€          const mapping = [["Development", project.scores.development], ["Location", project.scores.location], ["Masterplan", project.scores.masterplan], ["Facilities", project.scores.facilities], ["Type mix", project.scores.type], ["Price position", project.scores.price], ["Payment plan", project.scores.payment], ["Delivery", project.scores.delivery], ["Finishing", project.scores.finishing], ["Maintenance", project.scores.maintenance], ["Orientation", project.scores.orientation]];
â€          mapping.forEach(([label, value]) => { const span = document.createElement("span"); const v = typeof value === "number" ? value.toFixed(1) : "-"; span.innerHTML = `<strong>${label}</strong><span>${v}/10</span>`; rows.appendChild(span); });
â€          details.appendChild(rows);
â€          if (project.notes && project.notes.trim()) { const note = document.createElement("div"); note.style.marginTop="4px"; note.textContent = `Notes: ${project.notes}`; details.appendChild(note); }

â€          card.appendChild(header); card.appendChild(details); card.appendChild(footer);

â€          let pressTimer=null; let longPressed=false;
â€          card.addEventListener("pointerdown", ()=>{ longPressed=false; pressTimer=setTimeout(()=>{ const ok = confirm(`ØªÙ…Ø³Ø­ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ "${project.name}" Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ØŸ`); if (ok){ longPressed=true; const realMember = member.isAllTeam ? state.members.find(m=>(m.projects||[]).some(p=>p.id===project.id)) : member; if (realMember){ realMember.projects = realMember.projects.filter(p=>p.id!==project.id); saveState(); renderAll(); } } else longPressed=false; },650); });
â€          ["pointerup","pointerleave","pointercancel"].forEach(ev=> card.addEventListener(ev, ()=>{ if (pressTimer){ clearTimeout(pressTimer); pressTimer=null; } }));
â€          card.addEventListener("click", ()=>{ if (longPressed) return; card.classList.toggle("open"); if (!member.isAllTeam) startEditProject(project); });

â€          projectsListEl.appendChild(card);
        });
      }

â€      // training plan
â€      const lines=[]; const summaryCounts={};
â€      (member.projects || []).forEach(project => {
â€        const weakPoints=[]; const s = project.scores || {};
â€        Object.entries(s).forEach(([key, value])=> { const num = typeof value==="number"?value:0; const label = SCORE_LABELS[key] || key; if (num < 7) weakPoints.push(label); if (num <= 5) summaryCounts[label] = (summaryCounts[label]||0) + 1; });
â€        if (weakPoints.length > 0) {
â€          const ownerPrefix = member.isAllTeam && project.ownerName ? `${project.ownerName} â€“ ` : `${member.name} â€“ `;
â€          lines.push(`${ownerPrefix}${project.name}: Ù…Ø­ØªØ§Ø¬ ÙŠØ²ÙˆØ¯ Ù…Ø°Ø§ÙƒØ±ØªÙ‡ ÙÙŠ [${weakPoints.join("ØŒ ")}]`);
        }
      });

â€      if (lines.length === 0) trainingListEl.textContent = "Ù…ÙÙŠØ´ Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù ÙˆØ§Ø¶Ø­Ø© Ø¯Ù„ÙˆÙ‚ØªÙŠØŒ Ø´ØºÙ„ ÙƒÙˆÙŠØ³ ğŸ‘Œ";
â€      else { trainingListEl.innerHTML = ""; lines.forEach(l=>{ const div=document.createElement("div"); div.textContent = l; trainingListEl.appendChild(div); }); }

â€      const summaryEntries = Object.entries(summaryCounts).sort((a,b)=>b[1]-a[1]);
â€      if (summaryEntries.length === 0) trainingSummaryListEl.textContent = "Ù…ÙÙŠØ´ Ù†Ù‚Ø· Ù…ØªÙƒØ±Ø±Ø© Ø£Ù‚Ù„ Ù…Ù† Ù¥/Ù¡Ù  Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ ÙƒÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹.";
â€      else { trainingSummaryListEl.innerHTML = ""; summaryEntries.forEach(([label,count])=>{ const div=document.createElement("div"); div.textContent = `${label}: Ø¸Ù‡Ø± ÙÙŠ ${count} Ù…Ø´Ø±ÙˆØ¹ Ø¨Ø¯Ø±Ø¬Ø§Øª â‰¤ Ù¥`; trainingSummaryListEl.appendChild(div); }); }
    }

â€    function renderHeaderForMember(member){
â€      if (!member) { currentMemberTitle.textContent="Select team member"; currentMemberSub.textContent="Choose a team member from the left to start assessment."; return; }
â€      const currentDate = state.conversion.currentDate || todayISO();
â€      if (member.isAllTeam) {
â€        if (state.activeTab === "conversion") {
â€          const avg = computeConversionAllTeamAverage(currentDate);
â€          currentMemberTitle.textContent = "All team â€“ Conversion";
â€          currentMemberSub.textContent = `Overall team conversion (month): ${avg.toFixed(1)}% across ${state.members.length} member(s).`;
â€        } else {
â€          const avg = computeAssessmentAllTeamAverage();
â€          currentMemberTitle.textContent = "All team â€“ Assessment";
â€          currentMemberSub.textContent = `Overall team assessment: ${avg.toFixed(1)}% â€“ ${member.projects.length} project(s) total.`;
        }
â€      } else {
â€        if (state.activeTab === "conversion") {
â€          const avg = computeConversionMonthlyScoreForMember(member.id, currentDate);
â€          currentMemberTitle.textContent = `${member.name} â€“ Conversion`;
â€          currentMemberSub.textContent = `Monthly conversion score: ${avg.toFixed(1)}% (based on targets & activities this month).`;
â€        } else {
â€          const avg = computeAssessmentAverage(member);
â€          currentMemberTitle.textContent = member.name;
â€          currentMemberSub.textContent = `Overall assessment: ${avg.toFixed(1)}% â€“ ${member.projects.length} project(s) evaluated.`;
        }
      }
    }

â€    function clearForm(){ projectNameEl.value=""; projectDeveloperEl.value=""; projectRegionEl.value=""; projectNotesEl.value=""; scoreIds.forEach(id=>{ const el=document.getElementById(id); el.value=""; }); editingProjectId=null; formTitleEl.textContent = defaultFormTitle; }

â€    // Add member
â€    addMemberBtn.addEventListener("click", ()=>{ const name = newMemberInput.value.trim(); if (!name) return; const member = { id: uid(), name, projects: [] }; state.members.push(member); state.selectedMemberId = member.id; newMemberInput.value=""; saveState(); renderAll(); });
â€    newMemberInput.addEventListener("keydown", e=>{ if (e.key === "Enter") addMemberBtn.click(); });

â€    // Add/update project
â€    addProjectBtn.addEventListener("click", ()=>{
â€      let member = getCurrentMember(); if (!member || member.isAllTeam) { alert("Select a specific team member first (not All team)."); return; }
â€      const realMember = state.members.find(m=>m.id===member.id); if (!realMember) return;
â€      const name = projectNameEl.value.trim(); const developer = projectDeveloperEl.value.trim(); const region = projectRegionEl.value.trim(); if (!name){ alert("Please enter project name."); return; }
â€      const scores = {}; let sum=0; let count=0;
â€      function parseScore(id, keyName){ const el=document.getElementById(id); const v=parseFloat(el.value); const value = isNaN(v)?0:Math.min(Math.max(v,0),10); scores[keyName]=value; sum += value; count += 1; }
â€      parseScore("scoreDevelopment","development"); parseScore("scoreLocation","location"); parseScore("scoreMasterplan","masterplan"); parseScore("scoreFacilities","facilities"); parseScore("scoreType","type"); parseScore("scorePrice","price"); parseScore("scorePayment","payment"); parseScore("scoreDelivery","delivery"); parseScore("scoreFinishing","finishing"); parseScore("scoreMaintenance","maintenance"); parseScore("scoreOrientation","orientation");
â€      const avgScoreOutOf10 = count>0?sum/count:0; const overallPercent = (avgScoreOutOf10/10)*100;
â€      let isEdit=false;
â€      if (editingProjectId){
â€        const existing = realMember.projects.find(p=>p.id===editingProjectId);
â€        if (existing){ isEdit=true; const oldOverall = existing.overallPercent || 0; existing.name = name; existing.developer = developer; existing.region = region; existing.scores = scores; existing.notes = projectNotesEl.value.trim(); existing.lastReassessedAt = Date.now(); existing.lastDelta = overallPercent - oldOverall; existing.overallPercent = overallPercent; }
      }
â€      if (!isEdit){ const project = { id: uid(), name, developer, region, scores, notes: projectNotesEl.value.trim(), overallPercent, createdAt: Date.now() }; realMember.projects.push(project); }
â€      saveState(); clearForm(); renderAll();
    });

â€    cancelEditBtn.addEventListener("click", ()=> clearForm());

â€    regionFilter.addEventListener("change", ()=>{ const member = getCurrentMember(); renderFiltersAndStats(member); renderProjectsList(member); });
â€    developerFilter.addEventListener("change", ()=>{ const member = getCurrentMember(); renderFiltersAndStats(member); renderProjectsList(member); });

â€    // Export / backup / restore
â€    exportBtn.addEventListener("click", ()=>{
â€      const member = getCurrentMember(); if (!member) { alert("Select a team member first."); return; }
â€      if (state.activeTab === "assessment") {
â€        const selectedRegion = regionFilter.value || "all"; const selectedDev = developerFilter.value || "all"; let projects = member.projects || [];
â€        projects = projects.filter(p=>{ const r=(p.region||"").trim(); const d=(p.developer||"").trim(); const regionMatch = selectedRegion==="all"?true:r===selectedRegion; const devMatch = selectedDev==="all"?true:d===selectedDev; return regionMatch && devMatch; });
â€        const lowProjects = projects.filter(p=>(p.overallPercent||0) <= 60).sort((a,b)=>a.overallPercent - b.overallPercent);
â€        const limited = lowProjects.slice(0,5);
â€        printProjectsListEl.innerHTML = "";
â€        if (limited.length === 0) { const div=document.createElement("div"); div.className="empty-state"; div.textContent="No projects â‰¤ 60% with current filters."; printProjectsListEl.appendChild(div); }
â€        else { limited.forEach(project=>{ const card=document.createElement("div"); card.className="card"; const header=document.createElement("div"); header.className="card-header"; const titleBlock=document.createElement("div"); titleBlock.className="card-title-block"; const title=document.createElement("div"); title.className="card-title"; title.textContent = project.name || "Untitled project"; const subtitle=document.createElement("div"); subtitle.className="card-subtitle"; const bits=[]; if (project.region) bits.push(project.region); if (project.developer) bits.push(project.developer); bits.push(`${project.overallPercent.toFixed(1)}%`); subtitle.textContent = bits.join(" â€¢ "); titleBlock.appendChild(title); titleBlock.appendChild(subtitle); const tagEl=document.createElement("div"); const tagInfo=tagFromPercent(project.overallPercent); tagEl.className="card-tag "+tagInfo.className; tagEl.textContent = tagInfo.text; header.appendChild(titleBlock); header.appendChild(tagEl); const footer=document.createElement("div"); footer.className="card-footer"; const scoreSpan=document.createElement("span"); scoreSpan.innerHTML = `<span class="bold">${project.overallPercent.toFixed(1)}%</span> avg (0â€“10 scale)`; footer.appendChild(scoreSpan); card.appendChild(header); card.appendChild(footer); printProjectsListEl.appendChild(card); }); }
      }
â€      window.print();
    });

â€    backupBtn.addEventListener("click", ()=>{
â€      const blob = new Blob([JSON.stringify(state, null, 2)], { type: "application/json" });
â€      const url = URL.createObjectURL(blob); const a=document.createElement("a"); a.href=url; a.download = `br_assessment_backup_${new Date().toISOString().slice(0,10)}.json`; document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
    });

â€    restoreFileInput.addEventListener("change", e=>{
â€      const file = e.target.files[0]; if (!file) return; const reader = new FileReader();
â€      reader.onload = evt => { try { const data = JSON.parse(evt.target.result); if (!data || !Array.isArray(data.members)) { alert("Invalid backup file."); return; } state = data; initConversionState(); saveState(); renderAll(); alert("Backup restored successfully."); } catch(err){ console.error(err); alert("Failed to read backup file."); } };
â€      reader.readAsText(file); restoreFileInput.value="";
    });

â€    restoreAutoBtn.addEventListener("click", ()=>{
â€      const raw = localStorage.getItem(AUTO_BACKUP_KEY); if (!raw) { alert("No auto backup found."); return; }
â€      try { const data = JSON.parse(raw); if (!data || !Array.isArray(data.members)) { alert("Invalid auto backup data."); return; } state = data; initConversionState(); saveState(); renderAll(); alert("Auto backup restored."); } catch(e){ console.error(e); alert("Failed to restore auto backup."); }
    });

â€    // Tabs switching
â€    tabButtons.forEach(btn=> btn.addEventListener("click", ()=>{ const tab = btn.dataset.tab; state.activeTab = tab; saveState(); renderAll(); }));

â€    function renderTabs(){
â€      tabButtons.forEach(btn=> btn.classList.toggle("active", btn.dataset.tab === state.activeTab));
â€      assessmentTabEl.classList.toggle("hidden", state.activeTab !== "assessment");
â€      conversionTabEl.classList.toggle("hidden", state.activeTab !== "conversion");
â€      overviewTabEl.classList.toggle("hidden", state.activeTab !== "overview");
    }

â€    // Conversion targets rendering
â€    function renderConversionTargets(){
â€      initConversionState();
â€      const dateStr = state.conversion.currentDate || todayISO(); const days = daysInMonth(dateStr);
â€      convTargetsBody.innerHTML = "";
â€      CONV_TARGET_METRICS.forEach(metric=>{
â€        const row = document.createElement("tr");
â€        const cfg = state.conversion.targets[metric] || { mode:"day", value:0 };
â€        const daily = cfg.mode === "day" ? cfg.value : (cfg.value||0)/days;
â€        const monthly = cfg.mode === "day" ? (cfg.value||0)*days : cfg.value||0;
â€        const tdLabel = document.createElement("td"); tdLabel.textContent = CONV_LABELS[metric];
â€        const tdValue = document.createElement("td"); const input = document.createElement("input"); input.type="number"; input.step="1"; input.value = cfg.value ?? 0;
â€        input.addEventListener("change", ()=>{ const v = parseFloat(input.value); state.conversion.targets[metric].value = isNaN(v)?0:v; saveState(); renderConversionTargets(); renderConversionTable(); renderTeamList(); const member = getCurrentMember(); renderHeaderForMember(member); });
â€        tdValue.appendChild(input);
â€        const tdMode = document.createElement("td"); const sel = document.createElement("select"); ["day","month"].forEach(mode=>{ const opt=document.createElement("option"); opt.value=mode; opt.textContent = mode==="day" ? "Per day" : "Per month"; sel.appendChild(opt); }); sel.value = cfg.mode;
â€        sel.addEventListener("change", ()=>{ state.conversion.targets[metric].mode = sel.value; saveState(); renderConversionTargets(); renderConversionTable(); renderTeamList(); const member = getCurrentMember(); renderHeaderForMember(member); });
â€        tdMode.appendChild(sel);
â€        const tdDaily = document.createElement("td"); tdDaily.textContent = daily ? daily.toFixed(1) : "-";
â€        const tdMonthly = document.createElement("td"); tdMonthly.textContent = monthly ? monthly.toFixed(1) : "-";
â€        row.appendChild(tdLabel); row.appendChild(tdValue); row.appendChild(tdMode); row.appendChild(tdDaily); row.appendChild(tdMonthly);
â€        convTargetsBody.appendChild(row);
      });
    }

â€    // Conversion table rendering
â€    function renderConversionTable(){
â€      convTableBody.innerHTML = "";
â€      const dateStr = state.conversion.currentDate || todayISO();
â€      convDateEl.value = dateStr;
â€      const entriesForDay = state.conversion.entries[dateStr] || {};

â€      if (!state.members.length) {
â€        const tr = document.createElement("tr"); const td=document.createElement("td"); td.colSpan=9; td.textContent="Add team members from Assessment tab first."; tr.appendChild(td); convTableBody.appendChild(tr); convSummaryEl.textContent="Ù…ÙÙŠØ´ ØªÙŠÙ… Ù„Ø³Ù‡."; return;
      }

â€      const totalsToday = {}; CONV_METRICS.forEach(m=> totalsToday[m]=0);
â€      const [year,month] = dateStr.split("-"); const monthPrefix = `${year}-${month}`;
â€      const monthlyTotalsBySales = {};
â€      state.members.forEach(member=>{
â€        const totals = {}; CONV_METRICS.forEach(m=> totals[m]=0);
â€        Object.entries(state.conversion.entries).forEach(([d, perMember])=>{
â€          if (!d.startsWith(monthPrefix)) return;
â€          const entry = perMember[member.id]; if (!entry) return;
â€          CONV_METRICS.forEach(metric => totals[metric] += entry[metric] || 0);
        });
â€        monthlyTotalsBySales[member.id] = totals;
      });

â€      const monthlyTargetPerMetric = {}; CONV_METRICS.forEach(metric => monthlyTargetPerMetric[metric] = getMonthlyTarget(metric, dateStr));

â€      state.members.forEach(member=>{
â€        const tr = document.createElement("tr");
â€        const nameTd = document.createElement("td"); nameTd.className="sales-name-cell"; nameTd.textContent = member.name; tr.appendChild(nameTd);
â€        let sumPercents=0; let countPercents=0;
â€        const entryForDay = entriesForDay[member.id] || {};
â€        CONV_METRICS.forEach(metric => {
â€          const td = document.createElement("td");
â€          const input = document.createElement("input"); input.type="number"; input.step="1";
â€          const current = entryForDay[metric] || 0; input.value = current;
â€          input.addEventListener("change", ()=> {
â€            const v = parseFloat(input.value);
â€            if (!state.conversion.entries[dateStr]) state.conversion.entries[dateStr] = {};
â€            if (!state.conversion.entries[dateStr][member.id]) state.conversion.entries[dateStr][member.id] = {};
â€            state.conversion.entries[dateStr][member.id][metric] = isNaN(v)?0:v;
â€            saveState(); renderConversionTable(); renderTeamList(); const m = getCurrentMember(); renderHeaderForMember(m);
          });
â€          td.appendChild(input);
â€          const dailyTarget = getDailyTargetForPercent(metric, dateStr);
â€          if (hasTarget(metric) && dailyTarget > 0) {
â€            let percent = (current / dailyTarget) * 100;
â€            const span = document.createElement("div"); span.className = "percent-chip " + percentClass(percent); span.textContent = `${percent.toFixed(0)}%`;
â€            td.appendChild(span);
â€            sumPercents += percent; countPercents++;
          }
â€          totalsToday[metric] += current;
â€          tr.appendChild(td);
        });
â€        const tdTotal = document.createElement("td");
â€        if (countPercents > 0) { const avgPercent = sumPercents / countPercents; const span = document.createElement("span"); span.className = percentClass(avgPercent); span.textContent = `${avgPercent.toFixed(0)}%`; tdTotal.appendChild(span); } else tdTotal.textContent = "-";
â€        tr.appendChild(tdTotal);
â€        convTableBody.appendChild(tr);

â€        // sales total row
â€        const totalsForSales = monthlyTotalsBySales[member.id] || {};
â€        const totalRow = document.createElement("tr"); totalRow.className="sales-total-row";
â€        const totalNameTd = document.createElement("td"); totalNameTd.className="sales-name-cell"; totalNameTd.textContent = `${member.name} total`; totalRow.appendChild(totalNameTd);
â€        let monthlySumPercents=0; let monthlyCountPercents=0;
â€        CONV_METRICS.forEach(metric=>{
â€          const td = document.createElement("td"); const totalVal = totalsForSales[metric] || 0; const monthlyTarget = monthlyTargetPerMetric[metric] || 0;
â€          if (hasTarget(metric) && monthlyTarget > 0) {
â€            const pct = (totalVal / monthlyTarget) * 100;
â€            td.textContent = `${totalVal} - `;
â€            const span = document.createElement("span"); span.className = "percent-chip " + percentClass(pct); span.textContent = `${pct.toFixed(0)}%`; td.appendChild(span);
â€            monthlySumPercents += pct; monthlyCountPercents++;
â€          } else { td.textContent = totalVal || 0; }
â€          totalRow.appendChild(td);
        });
â€        const tdTotalMonth = document.createElement("td");
â€        if (monthlyCountPercents>0) { const avgMonth = monthlySumPercents / monthlyCountPercents; const span = document.createElement("span"); span.className = percentClass(avgMonth); span.textContent = `${avgMonth.toFixed(0)}%`; tdTotalMonth.appendChild(span); } else tdTotalMonth.textContent="-";
â€        totalRow.appendChild(tdTotalMonth);
â€        convTableBody.appendChild(totalRow);
      });

â€      // summary for the day
â€      const lines = [];
â€      CONV_METRICS.forEach(metric => {
â€        const total = totalsToday[metric];
â€        let line = `${CONV_LABELS[metric]}: ${total}`;
â€        const dailyTarget = getDailyTargetForPercent(metric, state.conversion.currentDate || todayISO());
â€        const teamTarget = hasTarget(metric) && dailyTarget > 0 ? dailyTarget * state.members.length : 0;
â€        if (teamTarget > 0) {
â€          const pct = (total / teamTarget) * 100;
â€          line += ` / team daily target ${teamTarget.toFixed(1)} â†’ ${pct.toFixed(0)}%`;
        }
â€        lines.push(line);
      });

â€      if (!Object.values(totalsToday).some(v=> v>0)) convSummaryEl.textContent = "Ù…ÙÙŠØ´ Ø£Ø±Ù‚Ø§Ù… Ù„Ù„ÙŠÙˆÙ… Ø¯Ù‡ Ù„Ø³Ù‡.";
â€      else convSummaryEl.innerHTML = lines.map(l=> `<div class="conversion-summary-line">${l}</div>`).join("");
    }

â€    convDateEl.addEventListener("change", ()=>{
â€      const val = convDateEl.value || todayISO(); state.conversion.currentDate = val; saveState(); renderConversionTargets(); renderConversionTable(); renderTeamList(); const member = getCurrentMember(); renderHeaderForMember(member);
    });

â€    // ===== Overview tab logic =====
â€    // overview month input: default to current month
â€    function monthToInputValue(dateStr){
â€      // dateStr "YYYY-MM-DD" or "YYYY-MM"
â€      if (!dateStr) return "";
â€      const parts = dateStr.split("-"); return `${parts[0]}-${parts[1]}`;
    }

â€    overviewMonthInput.addEventListener("change", ()=> { renderMembersOverview(); });

â€    function previousMonthPrefixFromMonthValue(monthValue){
â€      // monthValue "YYYY-MM"
â€      if (!monthValue) return null;
â€      const [y,m] = monthValue.split("-").map(n=>parseInt(n,10));
â€      const d = new Date(y, m-1, 1);
â€      d.setMonth(d.getMonth() - 1);
â€      const py = d.getFullYear(); const pm = String(d.getMonth()+1).padStart(2,"0");
â€      return `${py}-${pm}`;
    }

â€    function computeMemberCombined(member, monthValue){
â€      // 50/50 weighting: assessment average (0-100) and conversion monthly % (0-100)
â€      // monthValue is "YYYY-MM" or null -> use state.conversion.currentDate month
â€      const assessment = computeAssessmentAverage(member); // 0-100
â€      let monthStr;
â€      if (monthValue) monthStr = monthValue + "-01"; else monthStr = state.conversion.currentDate || todayISO();
â€      const conv = computeConversionMonthlyScoreForMember(member.id, monthStr);
â€      // if assessment or conv are NaN ensure numbers
â€      const a = isFinite(assessment) ? assessment : 0;
â€      const c = isFinite(conv) ? conv : 0;
â€      const combined = (a * 0.5) + (c * 0.5);
â€      return { assessment: a, conversion: c, combined };
    }

â€    function renderMembersOverview(){
â€      overviewGrid.innerHTML = "";
â€      // set overview month label
â€      const monthValue = overviewMonthInput.value || (state.conversion.currentDate ? state.conversion.currentDate.slice(0,7) : todayISO().slice(0,7));
â€      overviewDateLabel.textContent = monthValue;
â€      // for each member render card
â€      state.members.forEach(member=>{
â€        const { assessment, conversion, combined } = computeMemberCombined(member, monthValue);
â€        const card = document.createElement("div"); card.className = "member-card";
â€        const top = document.createElement("div"); top.className = "member-top";
â€        const left = document.createElement("div");
â€        const name = document.createElement("div"); name.className="member-name"; name.textContent = member.name;
â€        const meta = document.createElement("div"); meta.className="member-meta"; meta.textContent = `${(member.projects?.length||0)} project(s)`;
â€        left.appendChild(name); left.appendChild(meta);

â€        // pill color same logic as team list for combined
â€        const pill = document.createElement("div"); pill.className = "team-score-pill";
â€        pill.textContent = `${combined.toFixed(0)}%`;
â€        if (combined < 60) pill.classList.add("pill-red"); else if (combined < 80) pill.classList.add("pill-yellow"); else pill.classList.add("pill-green");

â€        top.appendChild(left); top.appendChild(pill);
â€        card.appendChild(top);

â€        const scoresRow = document.createElement("div"); scoresRow.className="scores-row";
â€        const blockA = document.createElement("div"); blockA.className="score-block";
â€        blockA.innerHTML = `<div class="score-label">Assessment</div><div class="score-value">${assessment.toFixed(0)}%</div>`;
â€        const blockB = document.createElement("div"); blockB.className="score-block";
â€        blockB.innerHTML = `<div class="score-label">Conversion (${monthValue})</div><div class="score-value">${conversion.toFixed(0)}%</div>`;
â€        scoresRow.appendChild(blockA); scoresRow.appendChild(blockB);
â€        card.appendChild(scoresRow);

â€        const totalRow = document.createElement("div"); totalRow.className="total-performance";
â€        const leftTotal = document.createElement("div"); leftTotal.innerHTML = `<div style="font-size:11px;color:var(--text-muted)">Total performance (50/50)</div><div style="font-weight:700;font-size:16px">${combined.toFixed(0)}%</div>`;
â€        const trendEl = document.createElement("div"); trendEl.className="trend";
â€        // compute previous month combined and show arrow + diff
â€        const prevMonthPrefix = previousMonthPrefixFromMonthValue(monthValue);
â€        let prevCombined = 0;
â€        if (prevMonthPrefix) {
â€          // construct a dateStr like "YYYY-MM-01" to pass into conversion calc
â€          const prevDateStr = prevMonthPrefix + "-01";
â€          const prevAssessment = computeAssessmentAverage(member); // assessment is not time-based here, so same for prev - acceptable unless user wanted different
â€          const prevConv = computeConversionMonthlyScoreForMember(member.id, prevDateStr);
â€          prevCombined = (prevAssessment*0.5) + (prevConv*0.5);
â€        } else {
â€          prevCombined = combined; // flat if no prev
        }
â€        const diff = combined - prevCombined;
â€        if (diff > 0.5) { trendEl.classList.add("up"); trendEl.innerHTML = `<span>â–²</span><span>+${diff.toFixed(1)}%</span>`; }
â€        else if (diff < -0.5) { trendEl.classList.add("down"); trendEl.innerHTML = `<span>â–¼</span><span>${diff.toFixed(1)}%</span>`; }
â€        else { trendEl.classList.add("flat"); trendEl.innerHTML = `<span>â€”</span><span>0.0%</span>`; }

â€        totalRow.appendChild(leftTotal); totalRow.appendChild(trendEl);
â€        card.appendChild(totalRow);

â€        overviewGrid.appendChild(card);
      });
    }

â€    // Render all conversion targets, table, team, projects, overview
â€    function renderAll(){
â€      renderTabs();
â€      renderTeamList();
â€      const member = getCurrentMember();
â€      renderHeaderForMember(member);
â€      renderFiltersAndStats(member);
â€      renderProjectsList(member);

â€      if (!state.conversion.currentDate) state.conversion.currentDate = todayISO();
â€      renderConversionTargets();
â€      renderConversionTable();

â€      // overview defaults
â€      // set overview month input to currently selected conversion month if empty
â€      if (!overviewMonthInput.value) overviewMonthInput.value = (state.conversion.currentDate || todayISO()).slice(0,7);
â€      renderMembersOverview();
    }

â€    // init load
â€    loadState();
â€    renderAll();
â€  </script>
â€</body>
â€</html>